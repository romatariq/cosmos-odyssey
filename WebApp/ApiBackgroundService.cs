using System.Text.Json;
using DAL;
using Domain;
using Microsoft.EntityFrameworkCore;

namespace WebApp;

public class ApiBackgroundService: BackgroundService
{
    private readonly ILogger<ApiBackgroundService> _logger;
    private readonly IServiceProvider _serviceProvider;
    private readonly JsonSerializerOptions _jsonSerializerOptions;

    public ApiBackgroundService(ILogger<ApiBackgroundService> logger, IServiceProvider serviceProvider)
    {
        _logger = logger;
        _serviceProvider = serviceProvider;
        _jsonSerializerOptions = new JsonSerializerOptions
        {
            PropertyNameCaseInsensitive = true,
        };
    }

    protected override async Task ExecuteAsync(CancellationToken stoppingToken)
    {
        var fetchAgainIn = await DoWork();
        _logger.LogInformation("Fetching again in {fetchAgainIn} seconds", fetchAgainIn);

        using PeriodicTimer timer = new(TimeSpan.FromSeconds(fetchAgainIn));

        try
        {
            while (await timer.WaitForNextTickAsync(stoppingToken))
            {
                fetchAgainIn = await DoWork();
                timer.Period = TimeSpan.FromSeconds(fetchAgainIn);
                _logger.LogInformation("Fetching again in {fetchAgainIn} seconds", fetchAgainIn);
            }
        }
        catch (OperationCanceledException)
        {
            _logger.LogInformation("Timed Hosted Service is stopping.");
        }
    }

    private async Task<double> DoWork()
    {
        await using var scope = _serviceProvider.CreateAsyncScope();
        var context = scope.ServiceProvider.GetRequiredService<AppDbContext>();
        
        
        var latestTravelPrice = await context.TravelPrices
            .OrderByDescending(x => x.ValidUntil)
            .FirstOrDefaultAsync();
        
        if (latestTravelPrice?.ValidUntil > DateTime.Now)
        {
            return latestTravelPrice.ValidUntil.Subtract(DateTime.Now).TotalSeconds;
        }
        
        using var client = new HttpClient();
        _logger.LogInformation("Fetching travel prices from external API");
        var result = await client.GetStringAsync("https://cosmos-odyssey.azurewebsites.net/api/v1.0/TravelPrices");
        // var result =
        //     "{\"id\":\"42387f7c-2b48-4ea9-b8ba-3f5e9d1b262b\",\"validUntil\":\"2024-02-03T15:24:58.2020577Z\",\"legs\":[{\"id\":\"8e4e0b8b-3cc3-4505-a58f-7819a3cf7ab7\",\"routeInfo\":{\"id\":\"142a5f80-386e-43a6-a135-4636363aa754\",\"from\":{\"id\":\"7455ddde-6faa-425b-9af8-e33c936f5890\",\"name\":\"Earth\"},\"to\":{\"id\":\"fccb70d5-16af-4ef3-93d8-2e3d8ad580ab\",\"name\":\"Jupiter\"},\"distance\":628730000},\"providers\":[{\"id\":\"f5dfb55b-82c7-41eb-903f-4923fb82f843\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":507824.50,\"flightStart\":\"2024-02-17T02:02:58.2020751Z\",\"flightEnd\":\"2024-02-19T22:53:58.2020751Z\"},{\"id\":\"5746e95d-c829-49be-9901-cfcf51ce176d\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":256731.31,\"flightStart\":\"2024-02-09T06:54:58.2020991Z\",\"flightEnd\":\"2024-02-14T22:38:58.2020991Z\"},{\"id\":\"bee2cd92-75d6-4262-bb46-b977c0749faf\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":470249.39,\"flightStart\":\"2024-02-09T21:39:58.2021183Z\",\"flightEnd\":\"2024-02-15T20:40:58.2021183Z\"},{\"id\":\"764c966c-9980-43c7-9eb8-8de0a4efb6a8\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":386158.17,\"flightStart\":\"2024-02-09T19:52:58.2021375Z\",\"flightEnd\":\"2024-02-14T22:51:58.2021375Z\"},{\"id\":\"63c05602-5d7a-41f8-af04-5790b3da1182\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":232049.64,\"flightStart\":\"2024-02-16T06:24:58.2021583Z\",\"flightEnd\":\"2024-02-19T01:49:58.2021583Z\"},{\"id\":\"6abd3da0-d30b-411d-b4d6-df3230ad7ced\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":37038.40,\"flightStart\":\"2024-02-08T04:50:58.202178Z\",\"flightEnd\":\"2024-02-09T18:00:58.202178Z\"},{\"id\":\"a6279c58-ebda-448b-a492-504bb6c52a39\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":627321.26,\"flightStart\":\"2024-02-17T14:07:58.2021973Z\",\"flightEnd\":\"2024-02-22T07:25:58.2021973Z\"},{\"id\":\"d9d11b65-1d9d-4692-a64e-ec971e235904\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":387477.09,\"flightStart\":\"2024-02-08T14:44:58.2022164Z\",\"flightEnd\":\"2024-02-12T11:06:58.2022164Z\"},{\"id\":\"01ad5283-1879-404b-9231-1e0156b246e3\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":63045.29,\"flightStart\":\"2024-02-09T17:58:58.2022369Z\",\"flightEnd\":\"2024-02-13T23:31:58.2022369Z\"},{\"id\":\"86d3eaaa-f121-4bb6-8584-53205e2fa759\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":453538.10,\"flightStart\":\"2024-02-07T19:29:58.202256Z\",\"flightEnd\":\"2024-02-08T20:55:58.202256Z\"},{\"id\":\"be964f6c-f458-44ae-ae11-a711621135eb\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":4947.01,\"flightStart\":\"2024-02-15T01:53:58.2022752Z\",\"flightEnd\":\"2024-02-20T19:53:58.2022752Z\"},{\"id\":\"2e6865d2-e525-473b-8f36-e2b7af8c221e\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":168879.40,\"flightStart\":\"2024-02-15T23:51:58.2023029Z\",\"flightEnd\":\"2024-02-19T12:51:58.2023029Z\"},{\"id\":\"d029bebf-eead-4ea7-b676-4fa11c36fecb\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":415060.68,\"flightStart\":\"2024-02-07T22:34:58.2024713Z\",\"flightEnd\":\"2024-02-08T23:43:58.2024713Z\"},{\"id\":\"c8f53541-cdf3-460d-8508-f6e2e8853c68\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":60072.21,\"flightStart\":\"2024-02-18T14:12:58.2024918Z\",\"flightEnd\":\"2024-02-21T06:18:58.2024918Z\"},{\"id\":\"12abc3c0-9a69-4b51-a95c-81d01642c514\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":361692.49,\"flightStart\":\"2024-02-17T22:31:58.2025115Z\",\"flightEnd\":\"2024-02-19T07:22:58.2025115Z\"}]},{\"id\":\"43c4acbd-968e-4291-b966-42e2890f3756\",\"routeInfo\":{\"id\":\"98f3676d-156c-49ba-8ffd-084a1ebb6f7c\",\"from\":{\"id\":\"fc9e5692-293d-4218-926d-4bb481f61455\",\"name\":\"Earth\"},\"to\":{\"id\":\"96448864-b146-458e-97de-5a1866272760\",\"name\":\"Uranus\"},\"distance\":2723950000},\"providers\":[{\"id\":\"7a454fdc-fc45-4525-b520-3297a7555ac2\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":1311072.98,\"flightStart\":\"2024-02-08T05:43:58.2025376Z\",\"flightEnd\":\"2024-02-12T03:36:58.2025376Z\"},{\"id\":\"6dbcef84-ff3f-4e01-b9f1-686d162e47b1\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":2666336.21,\"flightStart\":\"2024-02-10T05:38:58.2025576Z\",\"flightEnd\":\"2024-02-14T14:17:58.2025576Z\"},{\"id\":\"8d5dc95c-220a-47a4-9d19-ffe3993b42c5\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":1804838.25,\"flightStart\":\"2024-02-09T06:39:58.2025771Z\",\"flightEnd\":\"2024-02-14T01:56:58.2025771Z\"},{\"id\":\"52d9e342-0320-4d52-8adb-2324e9fa0b6b\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":2222301.69,\"flightStart\":\"2024-02-15T23:07:58.2025999Z\",\"flightEnd\":\"2024-02-18T10:07:58.2025999Z\"},{\"id\":\"23131883-a17f-44da-aa10-632db5e3bbae\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":2624850.23,\"flightStart\":\"2024-02-18T00:40:58.2026198Z\",\"flightEnd\":\"2024-02-20T15:55:58.2026198Z\"},{\"id\":\"b377fa17-731b-4b52-a4c9-c27bc2dd296b\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":2197071.18,\"flightStart\":\"2024-02-14T15:10:58.2026397Z\",\"flightEnd\":\"2024-02-17T03:43:58.2026397Z\"},{\"id\":\"f4459075-a8da-47ff-953d-987192a175ec\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":1031274.40,\"flightStart\":\"2024-02-14T20:52:58.2026593Z\",\"flightEnd\":\"2024-02-20T04:05:58.2026593Z\"},{\"id\":\"578fdb72-c991-4239-8607-4a9d411ce0fd\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":1943489.82,\"flightStart\":\"2024-02-16T02:34:58.2026809Z\",\"flightEnd\":\"2024-02-18T17:56:58.2026809Z\"},{\"id\":\"a6a3167d-2cc6-41c4-aab0-19d210047bdc\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":312415.71,\"flightStart\":\"2024-02-05T20:39:58.2027005Z\",\"flightEnd\":\"2024-02-10T17:25:58.2027005Z\"},{\"id\":\"1384fb61-93d6-47fa-ac1c-9fe31b52ac1d\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":2274305.28,\"flightStart\":\"2024-02-12T01:46:58.2027202Z\",\"flightEnd\":\"2024-02-16T01:43:58.2027202Z\"}]},{\"id\":\"ba8cc374-0bd2-4fc8-a4c4-07a84d143780\",\"routeInfo\":{\"id\":\"7a3fafe6-f14a-4794-a311-94d6c3ad73e0\",\"from\":{\"id\":\"c8be54a9-ca7c-4666-bd5d-a45baa628f05\",\"name\":\"Mercury\"},\"to\":{\"id\":\"cd95bc17-18e4-455e-a7b5-2bb5c6e1be20\",\"name\":\"Venus\"},\"distance\":50290000},\"providers\":[{\"id\":\"6f41e42d-abf8-44a1-aba5-aec04baa58de\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":37519.17,\"flightStart\":\"2024-02-07T23:09:58.2027444Z\",\"flightEnd\":\"2024-02-09T21:32:58.2027444Z\"},{\"id\":\"33068f4a-52df-4135-9a01-dca050b65bae\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":36438.43,\"flightStart\":\"2024-02-10T19:02:58.2027644Z\",\"flightEnd\":\"2024-02-14T00:54:58.2027644Z\"},{\"id\":\"fffaa8da-f0cb-48ee-a850-8fe4b75a00dc\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":27576.48,\"flightStart\":\"2024-02-13T10:08:58.2027999Z\",\"flightEnd\":\"2024-02-17T17:22:58.2027999Z\"},{\"id\":\"ce0bbef8-599b-41b5-b0d7-e30d952de87e\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":10432.00,\"flightStart\":\"2024-02-12T17:44:58.2028188Z\",\"flightEnd\":\"2024-02-15T08:10:58.2028188Z\"},{\"id\":\"d71bb177-2d4d-4ae2-a665-cb11a629102f\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":9424.57,\"flightStart\":\"2024-02-04T21:12:58.2028396Z\",\"flightEnd\":\"2024-02-09T20:01:58.2028396Z\"},{\"id\":\"7e355d0b-7583-49c2-8594-6d9deb5e7177\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":29086.36,\"flightStart\":\"2024-02-15T07:12:58.2028772Z\",\"flightEnd\":\"2024-02-17T20:12:58.2028772Z\"},{\"id\":\"e74dc497-9697-48be-b521-551b36afe924\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":13514.24,\"flightStart\":\"2024-02-07T07:14:58.202897Z\",\"flightEnd\":\"2024-02-13T02:12:58.202897Z\"},{\"id\":\"19507109-fbf0-44e8-b398-b84f9867227f\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":40419.63,\"flightStart\":\"2024-02-09T03:15:58.2029309Z\",\"flightEnd\":\"2024-02-12T16:06:58.2029309Z\"},{\"id\":\"136b2306-3e85-409d-bbdb-db8314392775\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":41036.38,\"flightStart\":\"2024-02-07T01:18:58.2029501Z\",\"flightEnd\":\"2024-02-11T14:24:58.2029501Z\"},{\"id\":\"a8365763-59ca-4f14-9361-e702060b07ba\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":26564.25,\"flightStart\":\"2024-02-11T18:53:58.2029694Z\",\"flightEnd\":\"2024-02-14T15:58:58.2029694Z\"}]},{\"id\":\"ca5ee1f6-60fc-4923-b9f0-ef5b8e72e167\",\"routeInfo\":{\"id\":\"e458d99e-f1f1-48d2-b681-3084b41db957\",\"from\":{\"id\":\"7bf19b21-df80-410d-8309-d9edfdc94841\",\"name\":\"Venus\"},\"to\":{\"id\":\"ca7be7cd-ef5f-4e6b-ab7c-5ba7083972f9\",\"name\":\"Mercury\"},\"distance\":50290000},\"providers\":[{\"id\":\"84048337-e3e6-450e-a2c0-65e52503cb8b\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":39480.21,\"flightStart\":\"2024-02-04T11:49:58.2029935Z\",\"flightEnd\":\"2024-02-05T22:58:58.2029935Z\"},{\"id\":\"0bbe6982-9a34-4b34-b976-cb93db829786\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":43065.28,\"flightStart\":\"2024-02-17T17:16:58.2030128Z\",\"flightEnd\":\"2024-02-20T20:02:58.2030128Z\"},{\"id\":\"4e7294bc-c424-43a3-aeae-42d268de32ac\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":29903.36,\"flightStart\":\"2024-02-18T11:00:58.2030326Z\",\"flightEnd\":\"2024-02-21T12:26:58.2030326Z\"},{\"id\":\"0b65d1e6-47c3-49c5-86de-45b3c9987861\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":2976.14,\"flightStart\":\"2024-02-07T16:29:58.2030525Z\",\"flightEnd\":\"2024-02-13T05:06:58.2030525Z\"},{\"id\":\"af2a96a4-bea1-4f11-bc74-69f51ff27bf7\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":44338.55,\"flightStart\":\"2024-02-11T03:20:58.2030752Z\",\"flightEnd\":\"2024-02-16T00:47:58.2030752Z\"},{\"id\":\"3eacd05c-3c63-4c58-a589-df7595a2e4e1\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":332.15,\"flightStart\":\"2024-02-04T04:26:58.2030948Z\",\"flightEnd\":\"2024-02-09T03:14:58.2030948Z\"},{\"id\":\"51084267-d181-4467-8188-766df9bad236\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":4447.02,\"flightStart\":\"2024-02-16T02:48:58.2031147Z\",\"flightEnd\":\"2024-02-17T08:17:58.2031147Z\"},{\"id\":\"d120d703-6fcb-44ac-932b-9ee63ddaa071\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":16789.15,\"flightStart\":\"2024-02-13T23:40:58.203136Z\",\"flightEnd\":\"2024-02-15T12:17:58.203136Z\"},{\"id\":\"36639981-ba85-4710-b749-59e1bd0aff7e\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":4270.58,\"flightStart\":\"2024-02-16T14:49:58.2031551Z\",\"flightEnd\":\"2024-02-18T22:26:58.2031551Z\"},{\"id\":\"092af8e3-b694-4ca7-a73a-d8d20e367602\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":11791.33,\"flightStart\":\"2024-02-04T04:26:58.2031744Z\",\"flightEnd\":\"2024-02-07T02:18:58.2031744Z\"},{\"id\":\"e1bf192c-39b1-4eaf-a45e-79f1544f04bf\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":10449.41,\"flightStart\":\"2024-02-12T15:00:58.2031944Z\",\"flightEnd\":\"2024-02-17T07:42:58.2031944Z\"},{\"id\":\"5fe60939-8b71-4072-b630-7cc8aaf72a78\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":36544.54,\"flightStart\":\"2024-02-16T05:54:58.2032161Z\",\"flightEnd\":\"2024-02-18T21:00:58.2032161Z\"},{\"id\":\"97b43cf3-f9c7-4c53-97fa-e274fa90c5d1\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":5425.14,\"flightStart\":\"2024-02-07T13:44:58.2032359Z\",\"flightEnd\":\"2024-02-12T10:21:58.2032359Z\"}]},{\"id\":\"7452c224-9e0a-436b-96d8-31f8b37f1938\",\"routeInfo\":{\"id\":\"2b72d950-6071-4af0-a5a4-a1d4a7c381d1\",\"from\":{\"id\":\"8d0a1325-d0ca-48c3-9389-20b97666e07e\",\"name\":\"Venus\"},\"to\":{\"id\":\"84d40960-03ae-4769-a512-3d95da86ff8b\",\"name\":\"Earth\"},\"distance\":41400000},\"providers\":[{\"id\":\"abdafbe1-d2d5-49bc-b156-9f8348ddcf26\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":32215.01,\"flightStart\":\"2024-02-06T08:33:58.2032576Z\",\"flightEnd\":\"2024-02-12T06:43:58.2032576Z\"},{\"id\":\"09ed8717-28f1-4bd9-955a-071b9eb74f8a\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":9311.21,\"flightStart\":\"2024-02-03T22:26:58.2032789Z\",\"flightEnd\":\"2024-02-06T22:33:58.2032789Z\"},{\"id\":\"89248464-dec1-487e-b4bb-f555bdc49ea9\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":13854.50,\"flightStart\":\"2024-02-13T20:35:58.2087785Z\",\"flightEnd\":\"2024-02-17T17:52:58.2087785Z\"},{\"id\":\"0d7b2066-741c-4849-8033-a69808f78529\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":4257.56,\"flightStart\":\"2024-02-17T08:49:58.208799Z\",\"flightEnd\":\"2024-02-19T04:54:58.208799Z\"},{\"id\":\"9949df47-f529-40b5-b71b-2edc14160070\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":8353.97,\"flightStart\":\"2024-02-13T08:24:58.208819Z\",\"flightEnd\":\"2024-02-18T00:55:58.208819Z\"},{\"id\":\"2a755c3d-3c8b-4b35-9e5a-0cc2336461d1\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":5617.99,\"flightStart\":\"2024-02-17T09:30:58.2088441Z\",\"flightEnd\":\"2024-02-21T00:50:58.2088441Z\"},{\"id\":\"29ea0322-ede0-44e9-816c-616dfd093b67\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":22190.67,\"flightStart\":\"2024-02-09T18:02:58.2088642Z\",\"flightEnd\":\"2024-02-11T12:05:58.2088642Z\"},{\"id\":\"a58e7db7-b300-4dd1-935f-17ffd09e2ded\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":24291.12,\"flightStart\":\"2024-02-15T15:53:58.2088842Z\",\"flightEnd\":\"2024-02-20T21:10:58.2088842Z\"},{\"id\":\"1db34fb1-9b9e-4302-82b6-20bba83e757b\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":28118.04,\"flightStart\":\"2024-02-09T10:42:58.2089061Z\",\"flightEnd\":\"2024-02-11T01:36:58.2089061Z\"},{\"id\":\"34efdefa-da9e-494d-83b5-26757212d869\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":36633.66,\"flightStart\":\"2024-02-08T15:33:58.2089255Z\",\"flightEnd\":\"2024-02-14T08:22:58.2089255Z\"},{\"id\":\"fcb688dd-9128-4a74-904a-003f44fbe74c\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":12103.00,\"flightStart\":\"2024-02-11T11:27:58.208945Z\",\"flightEnd\":\"2024-02-15T09:42:58.208945Z\"},{\"id\":\"d77d0183-d231-410a-a5f5-ffa7e885a4ee\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":13492.49,\"flightStart\":\"2024-02-16T00:43:58.2089645Z\",\"flightEnd\":\"2024-02-18T13:05:58.2089645Z\"},{\"id\":\"2b302e5f-74ec-4516-b2da-5ba946eb11c8\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":14539.49,\"flightStart\":\"2024-02-10T01:02:58.2089864Z\",\"flightEnd\":\"2024-02-13T13:39:58.2089864Z\"},{\"id\":\"634491bf-7a76-45ea-9b05-9f35b5ce9e07\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":10373.54,\"flightStart\":\"2024-02-10T08:39:58.2090059Z\",\"flightEnd\":\"2024-02-13T18:10:58.2090059Z\"},{\"id\":\"635d2158-05d7-4a75-b392-9ee88f746a89\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":30273.19,\"flightStart\":\"2024-02-11T19:18:58.2090256Z\",\"flightEnd\":\"2024-02-13T12:38:58.2090256Z\"}]},{\"id\":\"497b3eaa-ab13-4494-83d7-fbf0d892d4b6\",\"routeInfo\":{\"id\":\"456b30ad-b833-4de0-ab5f-b15f6d5b3fe4\",\"from\":{\"id\":\"52aefe0d-31d8-49b2-a3e5-40939418074f\",\"name\":\"Mars\"},\"to\":{\"id\":\"750cc00c-ec15-4e5a-9c96-3edbe6cae9ed\",\"name\":\"Venus\"},\"distance\":119740000},\"providers\":[{\"id\":\"a03e2cf7-4cd5-46d8-8929-5a44f4144a0f\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":46837.70,\"flightStart\":\"2024-02-18T14:04:58.2090503Z\",\"flightEnd\":\"2024-02-20T07:10:58.2090503Z\"},{\"id\":\"6f8e2619-9177-4c6a-9c73-022a5b6341d5\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":16092.53,\"flightStart\":\"2024-02-14T19:08:58.20907Z\",\"flightEnd\":\"2024-02-19T03:38:58.20907Z\"},{\"id\":\"a3171b94-2d63-4437-9589-d81a54ba9b8c\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":109958.11,\"flightStart\":\"2024-02-15T10:03:58.2090898Z\",\"flightEnd\":\"2024-02-18T19:43:58.2090898Z\"},{\"id\":\"ce8d600d-1c4e-4f5b-b1aa-3a07dcbee516\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":57305.21,\"flightStart\":\"2024-02-12T04:11:58.2091095Z\",\"flightEnd\":\"2024-02-17T10:32:58.2091095Z\"},{\"id\":\"57beb313-211e-4b50-b2ed-83ba9e874d6f\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":77014.58,\"flightStart\":\"2024-02-15T12:26:58.2091313Z\",\"flightEnd\":\"2024-02-18T00:21:58.2091313Z\"},{\"id\":\"d73d33e5-5a58-40b3-b9ac-8884a2e6e299\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":42062.85,\"flightStart\":\"2024-02-11T16:28:58.2091511Z\",\"flightEnd\":\"2024-02-13T02:16:58.2091511Z\"},{\"id\":\"929c0f22-5d7b-48c9-b69b-af3b87bc5ad6\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":48082.19,\"flightStart\":\"2024-02-07T12:48:58.2091705Z\",\"flightEnd\":\"2024-02-09T19:53:58.2091705Z\"},{\"id\":\"9bd0687d-b8d5-44ce-9c3f-e67c2ad0525c\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":1610.94,\"flightStart\":\"2024-02-13T18:21:58.2091918Z\",\"flightEnd\":\"2024-02-19T12:50:58.2091918Z\"},{\"id\":\"e50b3e4a-6cda-4f28-ac11-fd369f1728ad\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":17103.80,\"flightStart\":\"2024-02-04T16:44:58.2092111Z\",\"flightEnd\":\"2024-02-06T15:41:58.2092111Z\"},{\"id\":\"fb801c13-32d2-4e4d-ba0c-0bc69aeb3131\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":69756.77,\"flightStart\":\"2024-02-03T21:48:58.2092305Z\",\"flightEnd\":\"2024-02-04T23:25:58.2092305Z\"},{\"id\":\"a7994774-cf45-413b-85e6-1f067e5ef0aa\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":60105.38,\"flightStart\":\"2024-02-08T23:33:58.2092504Z\",\"flightEnd\":\"2024-02-10T09:45:58.2092504Z\"},{\"id\":\"de5fd13a-6c88-4b74-b4ab-106b5905b7e7\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":51725.53,\"flightStart\":\"2024-02-17T14:35:58.2092716Z\",\"flightEnd\":\"2024-02-19T00:52:58.2092716Z\"},{\"id\":\"6b42ea82-72ea-4b54-be8b-337800e5f95b\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":92447.71,\"flightStart\":\"2024-02-06T12:55:58.2092915Z\",\"flightEnd\":\"2024-02-08T11:22:58.2092915Z\"},{\"id\":\"64cbc3d8-7bf2-419f-bedc-cc2defbe83ce\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":3066.29,\"flightStart\":\"2024-02-10T10:09:58.2093107Z\",\"flightEnd\":\"2024-02-14T13:32:58.2093107Z\"}]},{\"id\":\"24800586-b267-45b9-80b5-f746798b4899\",\"routeInfo\":{\"id\":\"6dbbfed3-6943-476f-9203-2252ba67ab82\",\"from\":{\"id\":\"0200b07e-afac-4982-bf48-8d1b0b96a3fd\",\"name\":\"Jupiter\"},\"to\":{\"id\":\"ff04dcb7-9477-4234-9d60-1722e0930abb\",\"name\":\"Mars\"},\"distance\":550390000},\"providers\":[{\"id\":\"8b162723-40d3-40ba-8f64-b556a8dffa68\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":37318.32,\"flightStart\":\"2024-02-09T21:17:58.2093346Z\",\"flightEnd\":\"2024-02-15T02:43:58.2093346Z\"},{\"id\":\"13e14294-d9fd-43c6-a4ee-8007e4ddfbfa\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":399839.03,\"flightStart\":\"2024-02-16T15:49:58.2093539Z\",\"flightEnd\":\"2024-02-19T12:41:58.2093539Z\"},{\"id\":\"c8a168ed-0fa6-43a8-b5b6-594a9970972b\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":398117.09,\"flightStart\":\"2024-02-13T06:01:58.2093733Z\",\"flightEnd\":\"2024-02-16T18:18:58.2093733Z\"},{\"id\":\"b5bf4890-c971-4e7c-b31e-3a167a0f38e9\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":506334.79,\"flightStart\":\"2024-02-04T23:29:58.2093943Z\",\"flightEnd\":\"2024-02-10T01:28:58.2093943Z\"},{\"id\":\"692987ca-14e3-4014-91b0-d9b61457a223\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":26727.92,\"flightStart\":\"2024-02-09T07:52:58.2094135Z\",\"flightEnd\":\"2024-02-14T05:33:58.2094135Z\"},{\"id\":\"a4e4ea01-1895-42d4-94bd-9f5f1c412bcb\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":108372.48,\"flightStart\":\"2024-02-16T15:55:58.2094327Z\",\"flightEnd\":\"2024-02-17T21:26:58.2094327Z\"},{\"id\":\"11a87f2a-3b1c-46c9-8393-e0ef35fcfcf8\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":364853.64,\"flightStart\":\"2024-02-08T08:25:58.2094523Z\",\"flightEnd\":\"2024-02-11T21:21:58.2094523Z\"},{\"id\":\"4b6abec0-e75c-4a56-8855-13c8f5614f12\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":478030.81,\"flightStart\":\"2024-02-09T13:33:58.2094735Z\",\"flightEnd\":\"2024-02-14T08:55:58.2094735Z\"},{\"id\":\"fe594a69-737b-4044-8d0f-b0799ff293b2\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":336186.50,\"flightStart\":\"2024-02-10T23:42:58.2094929Z\",\"flightEnd\":\"2024-02-16T20:08:58.2094929Z\"},{\"id\":\"8e0c2bd4-5383-4861-82f2-952dfbe09934\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":352014.09,\"flightStart\":\"2024-02-13T00:31:58.2095128Z\",\"flightEnd\":\"2024-02-15T05:42:58.2095128Z\"},{\"id\":\"e972ae9c-f7a1-4e6a-88b0-8c249e446da4\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":178009.60,\"flightStart\":\"2024-02-14T00:32:58.2095343Z\",\"flightEnd\":\"2024-02-15T10:57:58.2095343Z\"},{\"id\":\"6a231da2-8a71-4c89-acb7-5aefcd8a9365\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":102995.22,\"flightStart\":\"2024-02-06T05:15:58.2095541Z\",\"flightEnd\":\"2024-02-10T06:00:58.2095541Z\"},{\"id\":\"febdd089-1fdf-4e01-b8c0-6f55988c4348\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":149776.09,\"flightStart\":\"2024-02-09T12:30:58.2095735Z\",\"flightEnd\":\"2024-02-14T04:40:58.2095735Z\"},{\"id\":\"e86af401-bec8-4cfd-bd5c-b5d1253a997e\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":309302.59,\"flightStart\":\"2024-02-16T23:45:58.2095931Z\",\"flightEnd\":\"2024-02-22T06:31:58.2095931Z\"},{\"id\":\"a0531c65-ac1c-4f7b-80df-0b5fa1c1b728\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":495568.11,\"flightStart\":\"2024-02-07T10:46:58.2096147Z\",\"flightEnd\":\"2024-02-09T03:48:58.2096147Z\"},{\"id\":\"1a7f3c4e-f964-4eac-8f41-d031a2698484\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":457022.73,\"flightStart\":\"2024-02-15T17:36:58.2096341Z\",\"flightEnd\":\"2024-02-16T19:13:58.2096341Z\"}]},{\"id\":\"88357b84-4ce9-40c5-9da0-135a70057da4\",\"routeInfo\":{\"id\":\"2575a809-9e1f-4c46-a9b9-7a1522e1cfb0\",\"from\":{\"id\":\"464faefb-7515-456f-a391-9cdcb3eb7968\",\"name\":\"Jupiter\"},\"to\":{\"id\":\"d38fcdf7-1e01-4b3c-8c59-938c5f296077\",\"name\":\"Venus\"},\"distance\":670130000},\"providers\":[{\"id\":\"89eb55a5-1b65-4c84-83a9-e57d3fee1403\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":22315.92,\"flightStart\":\"2024-02-16T04:12:58.2097495Z\",\"flightEnd\":\"2024-02-19T16:34:58.2097495Z\"},{\"id\":\"4bb21445-91f0-41d4-8075-d840f8d69d5a\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":409155.56,\"flightStart\":\"2024-02-12T12:57:58.209772Z\",\"flightEnd\":\"2024-02-15T16:34:58.209772Z\"},{\"id\":\"659112d0-439f-4c53-9538-d765a3cd00ab\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":639825.70,\"flightStart\":\"2024-02-17T19:04:58.2097918Z\",\"flightEnd\":\"2024-02-23T11:21:58.2097918Z\"},{\"id\":\"73cab6ba-7925-424d-b6fc-aa06a0ab3246\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":491779.21,\"flightStart\":\"2024-02-07T03:27:58.209811Z\",\"flightEnd\":\"2024-02-10T09:41:58.209811Z\"},{\"id\":\"1b9e980e-322b-4f4a-b5a7-e320fefb83ca\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":491417.66,\"flightStart\":\"2024-02-14T03:19:58.2098307Z\",\"flightEnd\":\"2024-02-19T03:22:58.2098307Z\"},{\"id\":\"b5c14aad-7d31-456e-8d15-bc0cba2b4b49\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":115106.51,\"flightStart\":\"2024-02-04T22:02:58.2098527Z\",\"flightEnd\":\"2024-02-10T17:02:58.2098527Z\"},{\"id\":\"1863a14c-6ea9-49e1-bd4c-a713ad85ac8a\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":135863.83,\"flightStart\":\"2024-02-05T09:59:58.209872Z\",\"flightEnd\":\"2024-02-07T13:27:58.209872Z\"},{\"id\":\"23d36309-f78d-485e-afd0-a34678fac09c\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":181795.59,\"flightStart\":\"2024-02-06T16:11:58.2098913Z\",\"flightEnd\":\"2024-02-11T11:44:58.2098913Z\"},{\"id\":\"144cc710-6ac3-4021-9063-f428c05c3acb\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":29159.95,\"flightStart\":\"2024-02-13T10:41:58.2099123Z\",\"flightEnd\":\"2024-02-15T15:33:58.2099123Z\"},{\"id\":\"fa9d7aab-f2ea-4142-88d1-430e02a6735c\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":403823.11,\"flightStart\":\"2024-02-10T02:40:58.2099321Z\",\"flightEnd\":\"2024-02-11T05:35:58.2099321Z\"},{\"id\":\"aeba2558-56c1-4ca8-acbb-6d99f2cefcfe\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":642210.32,\"flightStart\":\"2024-02-16T10:13:58.2099824Z\",\"flightEnd\":\"2024-02-18T12:43:58.2099824Z\"},{\"id\":\"3ea8134d-6f70-48e6-9ea0-94621d7c95bb\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":660740.93,\"flightStart\":\"2024-02-06T06:35:58.210002Z\",\"flightEnd\":\"2024-02-10T23:59:58.210002Z\"},{\"id\":\"9eb50f23-314c-40c4-a87a-461ed52cdf45\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":153383.23,\"flightStart\":\"2024-02-17T05:06:58.2101333Z\",\"flightEnd\":\"2024-02-21T09:54:58.2101333Z\"}]},{\"id\":\"0ec34d45-25a0-491d-9b6d-ad43707ef111\",\"routeInfo\":{\"id\":\"956e839f-d102-4998-aa40-e3013dd62de3\",\"from\":{\"id\":\"e5db239d-8180-47ca-a4a6-010ff6d99739\",\"name\":\"Saturn\"},\"to\":{\"id\":\"83633f2c-1470-4afc-a49c-ca65f6d76cd5\",\"name\":\"Earth\"},\"distance\":1275000000},\"providers\":[{\"id\":\"35e313d5-721c-4eaf-a1b4-a78cabf0cf93\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":1075949.38,\"flightStart\":\"2024-02-18T03:34:58.2101563Z\",\"flightEnd\":\"2024-02-22T19:26:58.2101563Z\"},{\"id\":\"76f0be47-7de0-4c1a-896a-739257de9d7c\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":162832.98,\"flightStart\":\"2024-02-16T07:50:58.2101765Z\",\"flightEnd\":\"2024-02-18T22:29:58.2101765Z\"},{\"id\":\"aef70543-37a6-4d3e-a554-06741574e91f\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":296805.27,\"flightStart\":\"2024-02-08T11:24:58.2101987Z\",\"flightEnd\":\"2024-02-10T03:59:58.2101987Z\"},{\"id\":\"69c7b6bd-035f-4028-9d73-9f9960c90253\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":124510.77,\"flightStart\":\"2024-02-04T14:25:58.2102182Z\",\"flightEnd\":\"2024-02-09T05:53:58.2102182Z\"},{\"id\":\"4eeb0b4e-381a-462a-9375-0ba65f57ee68\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":1010804.12,\"flightStart\":\"2024-02-15T18:01:58.2104162Z\",\"flightEnd\":\"2024-02-20T08:03:58.2104162Z\"},{\"id\":\"7ec6e923-9d48-4bad-a6c2-f8c2f4636369\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":622534.53,\"flightStart\":\"2024-02-04T22:47:58.2104365Z\",\"flightEnd\":\"2024-02-08T02:31:58.2104365Z\"},{\"id\":\"137c30df-3aa8-45c1-9a8a-afcd2bae62ea\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":818148.00,\"flightStart\":\"2024-02-15T20:48:58.2104584Z\",\"flightEnd\":\"2024-02-20T02:17:58.2104584Z\"},{\"id\":\"cadf9c98-0a77-4914-a2fe-69cb1f36612f\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":133861.03,\"flightStart\":\"2024-02-10T16:31:58.210477Z\",\"flightEnd\":\"2024-02-12T23:35:58.210477Z\"},{\"id\":\"73f3dd30-1a04-4305-9dae-1a902faa7098\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":76253.63,\"flightStart\":\"2024-02-14T06:13:58.2104957Z\",\"flightEnd\":\"2024-02-16T19:02:58.2104957Z\"},{\"id\":\"925d8296-adef-4f68-a1c4-5da208fc7b0e\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":1226084.46,\"flightStart\":\"2024-02-08T02:55:58.2105172Z\",\"flightEnd\":\"2024-02-09T18:57:58.2105172Z\"},{\"id\":\"e1204296-f14b-4dd4-8e6d-0b5d7c14f13e\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":13231.83,\"flightStart\":\"2024-02-13T23:42:58.2105364Z\",\"flightEnd\":\"2024-02-15T13:28:58.2105364Z\"},{\"id\":\"06978b47-a90a-45bb-9f4e-5c21bdd068aa\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":116926.70,\"flightStart\":\"2024-02-17T03:08:58.2105553Z\",\"flightEnd\":\"2024-02-19T12:45:58.2105553Z\"},{\"id\":\"7040d70e-6288-4f11-b3d9-712c93b3b338\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":979364.70,\"flightStart\":\"2024-02-15T22:38:58.2105743Z\",\"flightEnd\":\"2024-02-18T08:07:58.2105743Z\"},{\"id\":\"270cec58-480a-437a-a289-13383c12f819\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":952682.76,\"flightStart\":\"2024-02-12T00:13:58.2105949Z\",\"flightEnd\":\"2024-02-15T10:43:58.2105949Z\"},{\"id\":\"adb32b68-1972-44a4-95ba-3efed967add3\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":214883.09,\"flightStart\":\"2024-02-04T17:33:58.2106136Z\",\"flightEnd\":\"2024-02-08T23:20:58.2106136Z\"},{\"id\":\"87cde61f-d5a2-4a23-9756-b837bd4e778a\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":809297.65,\"flightStart\":\"2024-02-04T08:11:58.2106326Z\",\"flightEnd\":\"2024-02-08T21:58:58.2106326Z\"},{\"id\":\"8c0def98-821d-49f6-8ae5-c99b754bc005\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":537142.71,\"flightStart\":\"2024-02-09T08:10:58.2106539Z\",\"flightEnd\":\"2024-02-10T14:21:58.2106539Z\"}]},{\"id\":\"18a8e5db-3d2d-43ec-a83b-d024072f20b5\",\"routeInfo\":{\"id\":\"e5d23b1c-27ab-4117-affd-1ff422af6028\",\"from\":{\"id\":\"bc795712-5f24-47bc-9df4-64191433b2af\",\"name\":\"Saturn\"},\"to\":{\"id\":\"f6784f7a-5a36-47bb-bf2a-7d20483bbdb7\",\"name\":\"Neptune\"},\"distance\":3076400000},\"providers\":[{\"id\":\"8353ce65-17b6-4a5f-a8bb-12d8bbd623e4\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":714359.10,\"flightStart\":\"2024-02-11T22:01:58.2106756Z\",\"flightEnd\":\"2024-02-15T11:23:58.2106756Z\"},{\"id\":\"d113dfed-3733-4d21-96cc-66d67271d3fb\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":167180.74,\"flightStart\":\"2024-02-12T13:11:58.2106943Z\",\"flightEnd\":\"2024-02-18T11:25:58.2106943Z\"},{\"id\":\"ef269fca-6e82-43a5-8209-90ac0d0e9190\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":2499153.04,\"flightStart\":\"2024-02-12T12:32:58.2107145Z\",\"flightEnd\":\"2024-02-14T09:26:58.2107145Z\"},{\"id\":\"9ad7aec4-1c9c-4f2f-9b66-4e870b71dbb5\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":2621189.88,\"flightStart\":\"2024-02-09T11:35:58.2107333Z\",\"flightEnd\":\"2024-02-12T07:12:58.2107333Z\"},{\"id\":\"f64248c0-c84a-49c7-a40e-969c626d7134\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":1416406.61,\"flightStart\":\"2024-02-06T19:35:58.2107517Z\",\"flightEnd\":\"2024-02-08T22:31:58.2107517Z\"},{\"id\":\"dcb864a8-6915-4452-99ec-d70041c1909a\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":223132.01,\"flightStart\":\"2024-02-13T01:54:58.2107708Z\",\"flightEnd\":\"2024-02-17T01:06:58.2107708Z\"},{\"id\":\"9a458f47-27cc-4606-8449-3b29e28ffc8a\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":655771.22,\"flightStart\":\"2024-02-18T14:34:58.2107921Z\",\"flightEnd\":\"2024-02-20T07:02:58.2107921Z\"},{\"id\":\"2c99bd8b-321c-4530-872e-bf04f43d339f\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":1105089.54,\"flightStart\":\"2024-02-11T08:54:58.2108111Z\",\"flightEnd\":\"2024-02-15T00:33:58.2108111Z\"},{\"id\":\"c18dd1cf-3717-435d-9069-5617b062a55e\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":1995510.25,\"flightStart\":\"2024-02-03T22:37:58.2108297Z\",\"flightEnd\":\"2024-02-07T10:51:58.2108297Z\"},{\"id\":\"00082ce1-a588-49fd-9eed-dd89a8b48dcf\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":1129925.79,\"flightStart\":\"2024-02-08T16:25:58.2108506Z\",\"flightEnd\":\"2024-02-10T14:04:58.2108506Z\"},{\"id\":\"f61fce7d-d917-4e23-ae20-79b89d51c9e2\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":2799731.90,\"flightStart\":\"2024-02-10T14:06:58.2108696Z\",\"flightEnd\":\"2024-02-14T12:24:58.2108696Z\"},{\"id\":\"74318aea-cd8c-456d-b920-ed88d5f98e43\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":1389098.13,\"flightStart\":\"2024-02-15T10:38:58.2108887Z\",\"flightEnd\":\"2024-02-17T08:07:58.2108887Z\"},{\"id\":\"6959dadb-9ccc-4ba9-a515-70a2f7bc2d4b\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":2166713.78,\"flightStart\":\"2024-02-06T10:25:58.2109074Z\",\"flightEnd\":\"2024-02-09T20:48:58.2109074Z\"}]},{\"id\":\"f919a99b-aaef-4d38-8c99-f6e66e3cf742\",\"routeInfo\":{\"id\":\"fe924f93-91b8-4c18-9b3c-3c6bebbde055\",\"from\":{\"id\":\"0f5cbea1-cda4-4e25-a196-c88b3c1b9e2b\",\"name\":\"Uranus\"},\"to\":{\"id\":\"7be6467f-2fe8-4356-b8a1-46f5f5d52379\",\"name\":\"Saturn\"},\"distance\":1448950000},\"providers\":[{\"id\":\"cad0fa76-7fcb-431c-9155-0bb6a553dad7\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":389473.71,\"flightStart\":\"2024-02-14T23:30:58.2109484Z\",\"flightEnd\":\"2024-02-20T16:42:58.2109484Z\"},{\"id\":\"ba6cc890-2006-437c-80e8-6a9bfbae78e5\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":1258127.41,\"flightStart\":\"2024-02-12T08:34:58.2109684Z\",\"flightEnd\":\"2024-02-15T12:00:58.2109684Z\"},{\"id\":\"0da58411-43ba-4915-8ed9-7f09dec18370\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":766518.17,\"flightStart\":\"2024-02-15T00:36:58.210988Z\",\"flightEnd\":\"2024-02-18T02:47:58.210988Z\"},{\"id\":\"20e8b134-9a2b-4e5b-bf34-456e6b291af0\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":910296.04,\"flightStart\":\"2024-02-08T07:55:58.2110091Z\",\"flightEnd\":\"2024-02-10T06:05:58.2110091Z\"},{\"id\":\"1b8c6ccc-ca73-4ef2-ad39-4d58967873a7\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":399011.22,\"flightStart\":\"2024-02-05T16:01:58.2111242Z\",\"flightEnd\":\"2024-02-10T12:15:58.2111242Z\"},{\"id\":\"6db307fc-8899-437e-9a97-3c21beca0994\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":472008.65,\"flightStart\":\"2024-02-14T13:11:58.2111449Z\",\"flightEnd\":\"2024-02-17T23:11:58.2111449Z\"},{\"id\":\"2b417a3b-d905-4241-afb7-b0504f80f065\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":156763.40,\"flightStart\":\"2024-02-11T05:35:58.2111645Z\",\"flightEnd\":\"2024-02-15T22:19:58.2111645Z\"},{\"id\":\"ba58b261-2591-4c2f-a45f-42c8cde59272\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":451288.04,\"flightStart\":\"2024-02-11T02:30:58.2111878Z\",\"flightEnd\":\"2024-02-15T05:39:58.2111878Z\"},{\"id\":\"f6719f1f-199a-4111-8277-f38234b34374\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":183002.81,\"flightStart\":\"2024-02-14T13:06:58.2112073Z\",\"flightEnd\":\"2024-02-19T20:38:58.2112073Z\"},{\"id\":\"5c3bb629-c465-4b4b-96a2-aa49f5ed5156\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":323069.27,\"flightStart\":\"2024-02-09T11:40:58.2112267Z\",\"flightEnd\":\"2024-02-15T08:31:58.2112267Z\"},{\"id\":\"c46ec0b0-3f43-4c91-b1ab-404a08652648\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":27606.93,\"flightStart\":\"2024-02-14T00:28:58.2112481Z\",\"flightEnd\":\"2024-02-15T12:14:58.2112481Z\"},{\"id\":\"e2fb0c89-b25e-432c-b1de-75ee1d7c5dbf\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":266716.57,\"flightStart\":\"2024-02-15T22:03:58.211268Z\",\"flightEnd\":\"2024-02-17T12:49:58.211268Z\"},{\"id\":\"14691abb-e1d0-468e-8e53-25627aed0828\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":362572.75,\"flightStart\":\"2024-02-18T06:39:58.2112877Z\",\"flightEnd\":\"2024-02-21T01:14:58.2112877Z\"},{\"id\":\"de9894cd-b713-4764-be36-a31c46a4e16f\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":1021516.87,\"flightStart\":\"2024-02-17T13:15:58.2113072Z\",\"flightEnd\":\"2024-02-21T11:58:58.2113072Z\"}]},{\"id\":\"bc0d5571-5cba-41e3-9527-8c0e73273eb2\",\"routeInfo\":{\"id\":\"a0c4285c-4701-4cdb-b306-073355fc50ee\",\"from\":{\"id\":\"c0aba987-e857-41a2-a057-1971a29f35a8\",\"name\":\"Uranus\"},\"to\":{\"id\":\"f5cbd8d9-8cbf-473a-8924-edca4ad757cf\",\"name\":\"Neptune\"},\"distance\":1627450000},\"providers\":[{\"id\":\"2afc25f1-0010-43b1-a0b4-1ecdf50a89d2\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":458964.14,\"flightStart\":\"2024-02-04T10:38:58.2113315Z\",\"flightEnd\":\"2024-02-07T19:00:58.2113315Z\"},{\"id\":\"fd6d2ada-82ea-437b-ac35-78165a73757d\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":453181.01,\"flightStart\":\"2024-02-11T09:52:58.2113515Z\",\"flightEnd\":\"2024-02-14T09:11:58.2113515Z\"},{\"id\":\"cf7be938-a72b-4784-818c-5ace356be2a3\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":1112008.45,\"flightStart\":\"2024-02-18T07:06:58.2113711Z\",\"flightEnd\":\"2024-02-19T16:04:58.2113711Z\"},{\"id\":\"97a390ce-5e31-4978-95c8-6e6ef4a59576\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":951047.83,\"flightStart\":\"2024-02-09T11:24:58.2113927Z\",\"flightEnd\":\"2024-02-13T00:21:58.2113927Z\"},{\"id\":\"642d1787-aa1d-4391-bf91-610183d31eca\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":1388880.76,\"flightStart\":\"2024-02-08T04:25:58.2114124Z\",\"flightEnd\":\"2024-02-12T07:50:58.2114124Z\"},{\"id\":\"cc9e8a09-f465-40d7-a5f4-52ede1068b92\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":1611250.70,\"flightStart\":\"2024-02-12T09:08:58.2114324Z\",\"flightEnd\":\"2024-02-15T21:12:58.2114324Z\"},{\"id\":\"28be6935-22e7-4dfd-8e79-3cf1d3a4b464\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":542193.28,\"flightStart\":\"2024-02-12T05:49:58.211452Z\",\"flightEnd\":\"2024-02-18T04:48:58.211452Z\"},{\"id\":\"7eb0d58c-b833-482f-8cb6-ede81e8c7e03\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":1332201.95,\"flightStart\":\"2024-02-15T07:05:58.2114738Z\",\"flightEnd\":\"2024-02-18T04:02:58.2114738Z\"},{\"id\":\"37a1b750-e005-4a1e-ba04-af0b67f1d192\",\"company\":{\"id\":\"32edb89f-62f3-44af-b23c-21e7aefb343f\",\"name\":\"Explore Origin\"},\"price\":425299.34,\"flightStart\":\"2024-02-13T05:56:58.2114932Z\",\"flightEnd\":\"2024-02-15T00:14:58.2114932Z\"},{\"id\":\"2e85be81-65af-42df-8b5b-ab84897109f3\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":494765.76,\"flightStart\":\"2024-02-18T07:21:58.2115132Z\",\"flightEnd\":\"2024-02-21T00:19:58.2115132Z\"},{\"id\":\"c620fc14-584e-4e76-9994-a684e5d620dc\",\"company\":{\"id\":\"ec1d7f78-9bed-49a2-864f-5e425bcab87b\",\"name\":\"Travel Nova\"},\"price\":1618496.62,\"flightStart\":\"2024-02-17T06:43:58.2115344Z\",\"flightEnd\":\"2024-02-21T07:28:58.2115344Z\"}]},{\"id\":\"442c03bc-460f-41bf-ae25-15ead3c96afe\",\"routeInfo\":{\"id\":\"72150ae2-6cb1-4703-8ac8-f14f2cbee724\",\"from\":{\"id\":\"2d419fc2-b8d3-4ca3-8237-b9b76ffaa238\",\"name\":\"Neptune\"},\"to\":{\"id\":\"c26f8240-ff74-44fa-90f1-7d952ca7fc5c\",\"name\":\"Uranus\"},\"distance\":1627450000},\"providers\":[{\"id\":\"51c85aaa-96e4-4366-a94c-6de60485bd57\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":1012939.30,\"flightStart\":\"2024-02-06T07:23:58.2115566Z\",\"flightEnd\":\"2024-02-08T04:14:58.2115566Z\"},{\"id\":\"74e5f534-a57f-47f1-972c-59f4d503923f\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":1572515.97,\"flightStart\":\"2024-02-10T06:48:58.2115765Z\",\"flightEnd\":\"2024-02-11T12:04:58.2115765Z\"},{\"id\":\"e5e5496e-1aaa-4c87-b8d9-5c9959940a89\",\"company\":{\"id\":\"c39dab33-3880-49eb-ab03-23a4c4f8cfd4\",\"name\":\"Explore Dynamite\"},\"price\":78830.03,\"flightStart\":\"2024-02-05T04:07:58.2115961Z\",\"flightEnd\":\"2024-02-08T05:57:58.2115961Z\"},{\"id\":\"25df018f-d9f4-4961-853e-1e0bfb4bbd44\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":933475.37,\"flightStart\":\"2024-02-13T16:04:58.2116178Z\",\"flightEnd\":\"2024-02-15T07:02:58.2116178Z\"},{\"id\":\"884d34ca-0400-434f-a149-639ece649a6c\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":1117549.62,\"flightStart\":\"2024-02-10T21:28:58.2161739Z\",\"flightEnd\":\"2024-02-13T16:17:58.2161739Z\"},{\"id\":\"e9395e31-b016-4343-8ed6-bacd302ce192\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":897154.48,\"flightStart\":\"2024-02-11T17:06:58.2162115Z\",\"flightEnd\":\"2024-02-13T13:48:58.2162115Z\"},{\"id\":\"3a95920c-b294-4dd8-a5d9-a885b277f177\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":161240.69,\"flightStart\":\"2024-02-08T22:47:58.2162349Z\",\"flightEnd\":\"2024-02-14T08:02:58.2162349Z\"},{\"id\":\"73416969-e468-4a8e-ad00-c78be9ef714f\",\"company\":{\"id\":\"347c21c2-2bb6-4b47-ac29-17e1b41f192a\",\"name\":\"Space Odyssey\"},\"price\":110595.80,\"flightStart\":\"2024-02-17T00:23:58.216254Z\",\"flightEnd\":\"2024-02-20T17:21:58.216254Z\"},{\"id\":\"2e6939d4-4071-4989-a70c-6392c7509106\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":351080.27,\"flightStart\":\"2024-02-15T07:25:58.2162735Z\",\"flightEnd\":\"2024-02-19T23:46:58.2162735Z\"},{\"id\":\"80102beb-8ee6-47d5-83c5-65a123c542bc\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":1617450.67,\"flightStart\":\"2024-02-09T18:48:58.2162928Z\",\"flightEnd\":\"2024-02-14T08:57:58.2162928Z\"},{\"id\":\"cff66028-b4d3-4d08-b9a1-94579aff3991\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":1133493.73,\"flightStart\":\"2024-02-09T04:38:58.2163143Z\",\"flightEnd\":\"2024-02-10T06:01:58.2163143Z\"},{\"id\":\"8c5d1440-6739-4af5-9bfb-17430a962369\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":1518275.57,\"flightStart\":\"2024-02-14T14:17:58.2163331Z\",\"flightEnd\":\"2024-02-15T21:18:58.2163331Z\"},{\"id\":\"ff0713e7-85cc-44c3-9c27-7ceba5a4fda3\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":519305.45,\"flightStart\":\"2024-02-14T02:11:58.2163519Z\",\"flightEnd\":\"2024-02-19T05:37:58.2163519Z\"},{\"id\":\"daa71aec-61d4-4133-9a8b-e4843c1eae9f\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":1144805.09,\"flightStart\":\"2024-02-03T23:25:58.2163728Z\",\"flightEnd\":\"2024-02-09T06:41:58.2163728Z\"},{\"id\":\"f1e41eac-1fba-4105-bf7f-fdcac599f279\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":802239.03,\"flightStart\":\"2024-02-13T22:04:58.2163916Z\",\"flightEnd\":\"2024-02-19T03:52:58.2163916Z\"},{\"id\":\"5f996914-2476-4120-aa43-ee958da5d59e\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":129347.23,\"flightStart\":\"2024-02-09T16:51:58.2164104Z\",\"flightEnd\":\"2024-02-13T15:29:58.2164104Z\"}]},{\"id\":\"3107fa77-5654-4597-8274-df96a3770494\",\"routeInfo\":{\"id\":\"b5f98648-3414-486d-8809-5b18c3a57565\",\"from\":{\"id\":\"9501220c-2277-4f87-82ea-047c6bdfe0cd\",\"name\":\"Neptune\"},\"to\":{\"id\":\"ac0c0371-28f2-45b7-a06f-8bbf192e210f\",\"name\":\"Mercury\"},\"distance\":4443090000},\"providers\":[{\"id\":\"7c67271d-d4dd-4594-90d0-ad091e0b64d1\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":1157108.73,\"flightStart\":\"2024-02-04T09:00:58.2164338Z\",\"flightEnd\":\"2024-02-09T15:15:58.2164338Z\"},{\"id\":\"cb86dd19-b5bb-4eac-a5b3-e8dad505d341\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":600883.40,\"flightStart\":\"2024-02-11T08:33:58.2164528Z\",\"flightEnd\":\"2024-02-17T02:52:58.2164528Z\"},{\"id\":\"fcd0d5c3-7341-418f-81e6-371cc3993ece\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":2299834.88,\"flightStart\":\"2024-02-08T18:54:58.2164713Z\",\"flightEnd\":\"2024-02-14T06:44:58.2164713Z\"},{\"id\":\"b9ee05e3-b1b0-4b0d-b750-a9e3b871b170\",\"company\":{\"id\":\"ea1d3606-571e-4a73-a114-53afbce2c9fb\",\"name\":\"Space Voyager\"},\"price\":1414911.14,\"flightStart\":\"2024-02-13T19:58:58.2164906Z\",\"flightEnd\":\"2024-02-17T06:27:58.2164906Z\"},{\"id\":\"566a6762-7b9d-41d6-859a-c6c10291cb0a\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":3060887.68,\"flightStart\":\"2024-02-17T02:08:58.2165112Z\",\"flightEnd\":\"2024-02-19T03:31:58.2165112Z\"},{\"id\":\"23f84f14-2e43-44b5-a60f-ed178fbe33da\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":3301636.75,\"flightStart\":\"2024-02-04T01:34:58.2165303Z\",\"flightEnd\":\"2024-02-09T06:32:58.2165303Z\"},{\"id\":\"3267fa42-7b09-4fd3-a649-f65e1eab0b00\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":2061709.27,\"flightStart\":\"2024-02-07T06:26:58.2165489Z\",\"flightEnd\":\"2024-02-09T16:25:58.2165489Z\"},{\"id\":\"5f06e960-bc64-4078-858d-f205b9d90d95\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":4245947.57,\"flightStart\":\"2024-02-15T22:01:58.2165701Z\",\"flightEnd\":\"2024-02-21T01:53:58.2165701Z\"},{\"id\":\"e764248e-b89a-4e6d-a236-5628bf291bbd\",\"company\":{\"id\":\"73ba868e-ab99-4584-837b-dfcd9090e8a6\",\"name\":\"Spacelux\"},\"price\":3380029.71,\"flightStart\":\"2024-02-09T01:48:58.2165893Z\",\"flightEnd\":\"2024-02-10T03:26:58.2165893Z\"},{\"id\":\"fb313eb6-dda6-4dc6-83f1-11cbbb088662\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":3182895.47,\"flightStart\":\"2024-02-15T08:40:58.2166085Z\",\"flightEnd\":\"2024-02-19T12:12:58.2166085Z\"},{\"id\":\"ec5b3c3c-8507-430a-81de-ba0d3f4d0825\",\"company\":{\"id\":\"e70c2635-0e02-42dd-b463-01ac3333b29e\",\"name\":\"Spacegenix\"},\"price\":2006410.52,\"flightStart\":\"2024-02-11T18:05:58.2166277Z\",\"flightEnd\":\"2024-02-15T15:40:58.2166277Z\"},{\"id\":\"caf87a32-a1fc-4498-aeef-8dd150a70619\",\"company\":{\"id\":\"585ea6ae-be4a-4450-8514-5085e6abee6c\",\"name\":\"SpaceX\"},\"price\":2827179.43,\"flightStart\":\"2024-02-14T09:17:58.2166485Z\",\"flightEnd\":\"2024-02-17T14:19:58.2166485Z\"},{\"id\":\"010bba71-a04a-4764-90e1-31f3ece6b936\",\"company\":{\"id\":\"fd6fae57-861f-4dc6-8d4f-e9a34820374f\",\"name\":\"Space Piper\"},\"price\":3878257.63,\"flightStart\":\"2024-02-15T00:20:58.2166674Z\",\"flightEnd\":\"2024-02-18T00:24:58.2166674Z\"},{\"id\":\"dd7f305c-7ac2-4911-9032-d04a1720fde2\",\"company\":{\"id\":\"97010ac1-b012-4553-a5ff-0bd64ee4d76b\",\"name\":\"Galaxy Express\"},\"price\":1518194.85,\"flightStart\":\"2024-02-05T22:20:58.2166863Z\",\"flightEnd\":\"2024-02-08T02:45:58.2166863Z\"}]}]}";

        var travelPrice = JsonSerializer.Deserialize<TravelPrice>(result, _jsonSerializerOptions);

        if (travelPrice == null || travelPrice.Id == latestTravelPrice?.Id)
        {
            _logger.LogError("Failed to fetch travel price or miscalculated valid until.");
            return 30;
        }

        try
        {
            var companies = GetUniqueCompanies(travelPrice);
            await context.Companies.AddRangeAsync(companies);

            ParseTravelPriceToMatchDomain(travelPrice);
            await context.TravelPrices.AddAsync(travelPrice);
            await context.SaveChangesAsync();
        }
        catch (Exception e)
        {
            _logger.LogError(e, "Failed to save travel price to db.");
            return 30;
        }
        
        return travelPrice.ValidUntil.Subtract(DateTime.UtcNow).TotalSeconds;
    }
    
    
    private List<Company> GetUniqueCompanies(TravelPrice travelPrice)
    {
        return travelPrice.Legs!
            .SelectMany(l => l.Providers!)
            .Select(p => p.Company!)
            .GroupBy(c => c.Id)
            .Select(c => c.First())
            .ToList();
    }

    private void ParseTravelPriceToMatchDomain(TravelPrice travelPrice)
    {
        foreach (var leg in travelPrice.Legs?? [])
        {
            leg.TravelPriceId = travelPrice.Id;
            
            leg.RouteInfoId = leg.RouteInfo!.Id;
            leg.RouteInfo.FromId = leg.RouteInfo.From!.Id;
            leg.RouteInfo.ToId = leg.RouteInfo.To!.Id;
            
            foreach (var legProvider in leg.Providers?? [])
            {
                legProvider.LegId = leg.Id;
                legProvider.CompanyId = legProvider.Company!.Id;
                legProvider.Company = null;
            }
        }
    }
}